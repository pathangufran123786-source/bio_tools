<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>BLAST Results</title>
  <style>
    table { border-collapse: collapse; margin-top: 12px; }
    th, td { border: 1px solid #ccc; padding: 6px 8px; }
    th { background:#efefef; }
    pre { background:#fafafa; padding:10px; border:1px solid #eee; white-space: pre-wrap; word-wrap: break-word; }
  </style>
</head>
<body>
  <h1>BLAST Results</h1>

  {% if hits and hits|length > 0 %}
    <h2>Top Hits</h2>
    <table>
      <tr>
        <th>Title</th><th>Length</th><th>Score</th><th>E-value</th>
        <th>Identity</th><th>% Identity</th>
      </tr>
      {% for h in hits %}
        <tr>
          <td>{{ h.title }}</td>
          <td>{{ h.length }}</td>
          <td>{{ h.hsp_score or '-' }}</td>
          <td>{{ h.e_value or '-' }}</td>
          <td>{{ h.identity or '-' }} / {{ h.align_length or '-' }}</td>
          <td>{{ h.pct_identity if h.pct_identity is not none else '-' }}</td>
        </tr>
      {% endfor %}
    </table>

    <h3>First Hit Alignment</h3>
    {% if hits[0].query_seq %}
      <pre>
Query:  {{ hits[0].query_seq }}
Match:  {{ hits[0].match_seq }}
Sbjct:  {{ hits[0].sbjct_seq }}
      </pre>
    {% endif %}

  {% elif raw_xml %}
    <p>No parsed hits found â€” showing raw BLAST XML:</p>
    <pre>{{ raw_xml }}</pre>

  {% else %}
    <p>No results to display.</p>
  {% endif %}

  <p><a href="{{ url_for('blast') }}">Back to BLAST</a> | <a href="{{ url_for('home') }}">Home</a></p>
</body>
</html>
